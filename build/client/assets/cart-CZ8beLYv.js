import{g as i}from"./auth.service-m9myRVhg.js";import{c as s,L as d}from"./utils-CNtvmiS0.js";import{g as y}from"./product.service-Cwpiyzog.js";function l(){const t=localStorage.getItem(d);return t?JSON.parse(t):null}function C(t){localStorage.setItem(d,JSON.stringify(t))}async function g(){return s("/cart")}async function w(t){const r={items:t.map(({product:e,quantity:a})=>({productId:e.id,quantity:a}))};return s("/cart/create-items",{body:r})}async function I(t,r=1){return s("/cart/add-item",{body:{productId:t,quantity:r}})}async function L(t){return s(`/cart/delete-item/${t}`,{method:"DELETE"})}async function R(){return s("/cart",{method:"DELETE"})}function p(){localStorage.removeItem(d)}async function S(){const t=await i();try{const r=l();if(!t)return r;const e=await g();if(e!=null&&e.items.length)return p(),e;if(r){const a=await w(r.items);return p(),a}else return null}catch(r){return console.error(r),null}}async function T(t,r=1){const[e,a]=await Promise.all([i(),y(t)]);try{if(e)return await I(a.id,r);const o=l(),n=o?[...o.items]:[],c=n.find(u=>u.product.id===a.id);c?c.quantity+=r:r>0&&n.push({id:Date.now(),product:a,quantity:r});const m={id:Date.now(),items:n,total:n.reduce((u,f)=>u+f.product.price*f.quantity,0)};return C(m),m}catch(o){return console.error(o),null}}async function b(t){const r=await i();try{if(r)return await L(t);{const e=l(),a=e?e.items.filter(n=>n.id!==t):[],o={id:(e==null?void 0:e.id)||Date.now(),items:a,total:a.reduce((n,c)=>n+c.product.price*c.quantity,0)};return C(o),o}}catch(e){return console.error(e),null}}export{T as a,p as b,R as d,S as g,b as r};
