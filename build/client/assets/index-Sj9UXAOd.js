import{w as j}from"./with-props-D6VfJkxO.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{F as y,L as N,r as b,u as P}from"./chunk-LSOULM7L-BpBjtIwF.js";import{b as d,B as w}from"./index-C5VsBwWd.js";import{C as x}from"./index-Dmyz6W4A.js";import{g as v}from"./category.service-SbEtRakf.js";import{a as C}from"./product.service-Cwpiyzog.js";import{a as F}from"./utils-CNtvmiS0.js";import"./index-DwQA15mT.js";const L=["polos","stickers","tazas"];function S(s){return typeof s=="string"&&L.includes(s)}function B({minPrice:s,maxPrice:t,className:r}){return e.jsxs(y,{className:F("flex flex-col gap-6",r),children:[e.jsxs("fieldset",{children:[e.jsx("legend",{className:"text-base font-medium mb-4",children:"Precio"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Min"}),e.jsx(d,{type:"number",name:"minPrice",defaultValue:s,min:"0"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Max"}),e.jsx(d,{type:"number",name:"maxPrice",defaultValue:t,min:"0"})]})]})]}),e.jsx(w,{type:"submit",size:"xl",variant:"secondary",className:"w-full",children:"Filtrar Productos"})]})}function V({product:s}){return e.jsx(N,{to:`/products/${s.id}`,className:"block",children:e.jsxs("div",{className:"relative flex h-full flex-col overflow-hidden rounded-xl border border-separator group",children:[e.jsx("div",{className:"aspect-[3/4] bg-muted",children:e.jsx("img",{src:s.imgSrc,alt:s.title,loading:"lazy",className:"h-full w-full object-contain transition-transform duration-200 group-hover:scale-105"})}),e.jsxs("div",{className:"flex grow flex-col gap-2 p-4",children:[e.jsx("h2",{className:"text-sm font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("p",{className:"mt-auto text-base font-medium",children:["$",s.price]})]}),s.isOnSale&&e.jsx("span",{className:"absolute top-0 right-0 rounded-bl-xl bg-primary px-2 py-1 text-sm font-medium text-primary-foreground",children:"ðŸš€ Oferta"})]})})}async function A({params:s,request:t}){const{category:r}=s;if(!S(r))return b("/not-found");const a=new URL(t.url),l=a.searchParams.get("minPrice")||"",i=a.searchParams.get("maxPrice")||"";try{const[o,u]=await Promise.all([v(r),C(r)]),f=((p,c,n)=>{const g=c?parseFloat(c):0,h=n?parseFloat(n):1/0;return p.filter(m=>m.price>=g&&m.price<=h)})(u,l,i);return{category:o,products:f,minPrice:l,maxPrice:i}}catch(o){throw new Response("Error loading category: "+o,{status:500})}}const G=j(function(){const{category:t,products:r,minPrice:a,maxPrice:l}=P();return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"py-10 border-b border-border",children:e.jsx(x,{children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})})}),e.jsx("section",{className:"py-10",children:e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx(B,{minPrice:a,maxPrice:l,className:"w-full max-w-sm lg:max-w-xs"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 flex-grow",children:r.map(i=>e.jsx(V,{product:i}))})]})})})]})});export{A as clientLoader,G as default};
