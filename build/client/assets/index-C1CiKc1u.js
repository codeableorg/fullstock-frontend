import{w as j}from"./with-props-BBqpwT5E.js";import{j as e,F as y,L as N,r as b}from"./chunk-LSOULM7L-OaPJ-Plh.js";import{b as d,B as P}from"./index-Dbs4k1je.js";import{C as x}from"./index-C65Y4aBu.js";import{g as w}from"./category.service-SbEtRakf.js";import{a as v}from"./product.service-Cwpiyzog.js";import{a as C}from"./utils-CNtvmiS0.js";import"./index-BIC2x-iH.js";const F=["polos","stickers","tazas"];function S(s){return typeof s=="string"&&F.includes(s)}function B({minPrice:s,maxPrice:a,className:r}){return e.jsxs(y,{className:C("flex flex-col gap-6",r),children:[e.jsxs("fieldset",{children:[e.jsx("legend",{className:"text-base font-medium mb-4",children:"Precio"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Min"}),e.jsx(d,{type:"number",name:"minPrice",defaultValue:s,min:"0"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Max"}),e.jsx(d,{type:"number",name:"maxPrice",defaultValue:a,min:"0"})]})]})]}),e.jsx(P,{type:"submit",size:"xl",variant:"secondary",className:"w-full",children:"Filtrar Productos"})]})}function L({product:s}){return e.jsx(N,{to:`/products/${s.id}`,className:"block",children:e.jsxs("div",{className:"relative flex h-full flex-col overflow-hidden rounded-xl border border-separator group",children:[e.jsx("div",{className:"aspect-[3/4] bg-muted",children:e.jsx("img",{src:s.imgSrc,alt:s.title,loading:"lazy",className:"h-full w-full object-contain transition-transform duration-200 group-hover:scale-105"})}),e.jsxs("div",{className:"flex grow flex-col gap-2 p-4",children:[e.jsx("h2",{className:"text-sm font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("p",{className:"mt-auto text-base font-medium",children:["$",s.price]})]}),s.isOnSale&&e.jsx("span",{className:"absolute top-0 right-0 rounded-bl-xl bg-primary px-2 py-1 text-sm font-medium text-primary-foreground",children:"ðŸš€ Oferta"})]})})}async function $({params:s,request:a}){const{category:r}=s;if(!S(r))return b("/not-found");const l=new URL(a.url),i=l.searchParams.get("minPrice")||"",o=l.searchParams.get("maxPrice")||"";try{const[t,f]=await Promise.all([w(r),v(r)]),u=((g,c,n)=>{const p=c?parseFloat(c):0,h=n?parseFloat(n):1/0;return g.filter(m=>m.price>=p&&m.price<=h)})(f,i,o);return{category:t,products:u,minPrice:i,maxPrice:o}}catch(t){throw new Response("Error loading category: "+t,{status:500})}}const A=j(function({loaderData:a}){const{category:r,products:l,minPrice:i,maxPrice:o}=a;return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"py-10 border-b border-border",children:e.jsx(x,{children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})})}),e.jsx("section",{className:"py-10",children:e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx(B,{minPrice:i,maxPrice:o,className:"w-full max-w-sm lg:max-w-xs"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 flex-grow",children:l.map(t=>e.jsx(L,{product:t},t.id))})]})})})]})});export{$ as clientLoader,A as default};
